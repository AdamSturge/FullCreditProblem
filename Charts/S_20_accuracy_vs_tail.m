hold on

xMin = 0;
xMax = 0.3;
yMin = -12;
yMax = 0;
X = 1:xMax;

TwoLvlMCX = [0.1,0.1,0.1,0.1,0.1,...
             0.1125,0.1125,0.1125,0.1125,0.1125,...
             0.125,0.125,0.125,0.125,0.125,...
             0.15,0.15,0.15,0.15,0.15,...
             0.2,0.2,0.2,0.2,0.2];
        
TwoLvlMCY = [0.048557692307692307692307692307692, 0.049038461538461538461538461538462, 0.048653846153846153846153846153846, 0.049615384615384615384615384615385, 0.049230769230769230769230769230769,...
            0.024326923076923076923076923076923, 0.023173076923076923076923076923077, 0.022211538461538461538461538461538, 0.021442307692307692307692307692308, 0.023557692307692307692307692307692,...
            0.010192307692307692307692307692308, 0.010961538461538461538461538461538, 0.010288461538461538461538461538462, 0.010673076923076923076923076923077, 0.0089423076923076923076923076923077,...
            0.0018269230769230769230769230769231, 0.0010576923076923076923076923076923, 0.0015384615384615384615384615384615, 0.0025961538461538461538461538461538, 0.0017307692307692307692307692307692,...
            0.000096153846153846153846153846153846, 0.00019230769230769230769230769230769, 0, 0, 0.00019230769230769230769230769230769];

TwoLvlMCYMean = arrayfun(@(i) mean(TwoLvlMCY((5*i-4):(5*i))), 1:(length(TwoLvlMCY)/5));


TwoLvlISX = [0.1,0.1,0.1,0.1,0.1,...
            0.1125,0.1125,0.1125,0.1125,0.1125,...
            0.125,0.125,0.125,0.125,0.125,...
            0.15,0.15,0.15,0.15,0.15,...
            0.2,0.2,0.2,0.2,0.2];
        
TwoLvlISY = [0.041733500817650925895918589958455, 0.047497397545593948720021870713026, 0.043776815832248794357894894346828, 0.042790889884492581962671664541631, 0.05357615014756059862444104169299,...
            0.018003252202379825541722624393515, 0.02078674869471384620278620047884, 0.023444277646080709243125994589718, 0.022209068585509698229296660088039, 0.021756764401949880982645169069656,...
            0.013203477449089799991566174242053, 0.0098690749371540750778386552610755, 0.011628202035339303341276995240605, 0.012043551482002914573832264011344, 0,...
            0.002340861920298485492064610724583, 0.0019110803985055782594493223314203, 0.0016932787468453074867374974488143, 0, 0.0016366421982915437764033450562806,...
            0.000059572780767505239196083627328804, 0.000056536200739807042283269905569298, 0.000044911027560948177134603903626342, 0.000049723802225707397647001817286849, 0.000038303702842867587538468882035758];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

OneLvlISX = [0.1,0.1,0.1,0.1,0.1,...
            0.1125,0.1125,0.1125,0.1125,0.1125,...
            0.125,0.125,0.125,0.125,0.125,...
            0.15,0.15,0.15,0.15,0.15,...
            0.2,0.2,0.2,0.2,0.2
            ];
        
OneLvlISY = [0.054761931874715279178200688647848, 0.051515344299378137971068269962416, 0.04012967876078709500431429546552, 0.046685468989106804205135858865106, 0.062475636416017388263810516946251,...
            0.018840991321819700737849601068774, 0.025148043075129272727608054083248, 0.030938958415409098523518593992776, 0.021825796431467446578889024522141, 0.021919220531730260193015169534192,...
            0, 0.0096554831519566810399402001507951, 0.015096508588642160858528384892452, 0.024179444142066658374190524227743, 0.0084418745707594954746921800392556,...
            0.0014556761245345165283610056050634, 0.0020582735806971624512029528375479, 0.0091134066088660176108149357787624, 0.0032245105666501962596304231567501, 0,...
            0.000087138612324521197731105881523206, 0, 0.000033823382556734396466209535692116, 0.000062366555141792539901021696913119, 0.000082157723935386266916891528921951,...
            ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

s1 = scatter(TwoLvlMCX,log(TwoLvlMCY),'r', 'filled');
s2 = scatter(TwoLvlISX,log(TwoLvlISY),'b', 'filled');
s3 = scatter(OneLvlISX,log(OneLvlISY),'g', 'filled');
alpha(s1,0.4);
alpha(s2,0.4);
alpha(s3,0.4);

plot(unique(TwoLvlMCX),log(TwoLvlMCYMean),'r','LineWidth',1)
plot(unique(TwoLvlISX),log(TwoLvlISYMean),'b','LineWidth',1)
plot(unique(OneLvlISX),log(OneLvlISYMean),'g','LineWidth',1)


legend('TwoLvlMC','TwoLvlIS','OneLvlIS','E[TwoLvlMC]','E[TwoLvlIS]','E[OneLvlIS]')
title('S:20')
xlabel('x')
ylabel('log(P(Loss > x))')
axis([xMin,xMax,yMin,yMax])

hold off
